"use strict";(self.webpackChunkconsensys_asko11y_app=self.webpackChunkconsensys_asko11y_app||[]).push([[4372],{74372(e,t,r){r.r(t),r.d(t,{SharedSession:()=>b,default:()=>g});var n=r(85959),s=r.n(n),a=r(81159),i=r(82007),o=r(35458),l=r(51039),c=r(98852),u=r(18531),m=r(15331);function d(e,t,r,n,s,a,i){try{var o=e[a](i),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,s)}function f(e){return function(){var t=this,r=arguments;return new Promise(function(n,s){var a=e.apply(t,r);function i(e){d(a,n,s,i,o,"next",e)}function o(e){d(a,n,s,i,o,"throw",e)}i(void 0)})}}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){p(e,t,r[t])})}return e}function h(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}function b(){const{shareId:e}=(0,a.useParams)(),t=(0,a.useNavigate)(),r=(0,u.usePluginUserStorage)(),d=String(u.config.bootData.user.orgId||"1"),[p,b]=(0,n.useState)(null),[g,v]=(0,n.useState)(!0),[w,S]=(0,n.useState)(null),[O,E]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!e)return S("Share ID is required"),void v(!1);f(function*(){try{const t=yield o.T.getSharedSession(e);b(t)}catch(e){console.error("[SharedSession] Failed to load shared session:",e),404===(null==e?void 0:e.status)?S("This share link is not found or has expired."):403===(null==e?void 0:e.status)?S("You don't have access to this shared session. It may be from a different organization."):S("Failed to load shared session. Please try again later.")}finally{v(!1)}})()},[e]);if(g)return s().createElement("div",{className:"min-h-full w-full flex items-center justify-center"},s().createElement("div",{className:"text-center"},s().createElement("p",null,"Loading shared session...")));if(w||!p)return s().createElement("div",{className:"min-h-full w-full flex items-center justify-center p-4"},s().createElement("div",{className:"max-w-md w-full"},s().createElement(i.Alert,{title:"Error",severity:"error"},w||"Failed to load shared session"),s().createElement("div",{className:"mt-4"},s().createElement(i.Button,{variant:"primary",onClick:()=>t("/")},"Go to Home"))));const P=p.messages.map(e=>h(y({},e),{timestamp:new Date(e.timestamp||Date.now())})),j=m.v.fromStorage({id:p.id,title:p.title,messages:P,createdAt:p.createdAt,updatedAt:p.updatedAt,messageCount:P.length});return s().createElement("div",{className:"min-h-full w-full flex flex-col"},s().createElement("div",{className:"bg-primary/10 border-b border-primary/20 p-2"},s().createElement("div",{className:"flex items-center justify-between"},s().createElement("div",null,s().createElement("h2",{className:"text-sm font-semibold text-primary"},"Viewing Shared Session"),s().createElement("p",{className:"text-xs text-secondary mt-0.5"},"This is a shared session. You can view it or import it to your account.")),s().createElement(i.Button,{variant:"primary",size:"sm",onClick:()=>f(function*(){if(p){E(!0);try{const e=c.E.getSessionService(r),n=p.messages.map(e=>h(y({},e),{timestamp:new Date(e.timestamp||Date.now())}));yield e.createSession(d,n,p.title),yield new Promise(e=>setTimeout(e,100)),t("..",{replace:!0})}catch(e){console.error("[SharedSession] Failed to import session:",e),alert("Failed to import session. Please try again.")}finally{E(!1)}}})(),disabled:O},O?"Importing...":"Import as New Session"))),s().createElement("div",{className:"flex-1 flex flex-col min-h-0"},s().createElement(l.ry,{pluginSettings:{},readOnly:!0,initialSession:j})))}const g=b}}]);
//# sourceMappingURL=4372.64d61719.js.map